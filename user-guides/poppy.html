<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Poppy ergo jr - Ronoco-documentation</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Ronoco</li><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Users guides</li><li class="chapter-item expanded "><a href="../user-guides/installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../user-guides/quick-start.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../user-guides/how-to-use-it.html"><strong aria-hidden="true">4.</strong> How to use it</a></li><li class="chapter-item expanded "><a href="../user-guides/bt.html"><strong aria-hidden="true">5.</strong> How to create a behaviour tree</a></li><li class="chapter-item expanded "><a href="../user-guides/poppy.html" class="active"><strong aria-hidden="true">6.</strong> Examples on robots</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../user-guides/poppy.html" class="active"><strong aria-hidden="true">6.1.</strong> Poppy ergo jr</a></li><li class="chapter-item expanded "><a href="../user-guides/ur3.html"><strong aria-hidden="true">6.2.</strong> Universal Robots 3</a></li><li class="chapter-item expanded "><a href="../user-guides/kuka.html"><strong aria-hidden="true">6.3.</strong> Kuka KR6</a></li><li class="chapter-item expanded "><a href="../dev-guides/own.html"><strong aria-hidden="true">6.4.</strong> Add your own robot</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Ronoco API Documentation</li><li class="chapter-item expanded "><a href="../documentation/api-short.html"><strong aria-hidden="true">7.</strong> API - summarize</a></li><li class="chapter-item expanded "><a href="../documentation/api-detailed.html"><strong aria-hidden="true">8.</strong> API - detailed</a></li><li class="chapter-item expanded "><a href="../documentation/behavior.html"><strong aria-hidden="true">9.</strong> Behaviours</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Ronoco-documentation</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="example-on-poppy-ergo-jr"><a class="header" href="#example-on-poppy-ergo-jr">Example on Poppy Ergo Jr</a></h1>
<p>This page presents a complete use of ronoco on a <a href="https://github.com/poppy-project/poppy-ergo-jr">poppy ergo jr</a> it uses the resources of <a href="https://learn.e.ros4.pro/fr/manipulation/ergo-jr/">learn.e.ros4.pro</a> concerning the Poppy Ergo Jr.</p>
<p>It is necessary to have a ROS installation, a ROS workspace and ronoco to follow this page. Refer to the <a href="installation.html">installation guide</a> if necessary.</p>
<h2 id="prepare-poppy-ergo-jr"><a class="header" href="#prepare-poppy-ergo-jr">Prepare Poppy Ergo Jr</a></h2>
<p>Start by <a href="https://docs.poppy-project.org/fr/assembly-guides/ergo-jr/">assembling your robot</a>, following the steps for ROS if applicable, then <a href="https://docs.poppy-project.org/fr/assembly-guides/ergo-jr/motor-configuration.html#32ter-configurer-les-moteurs-un-par-un-si-vous-utilisez-une-image-ros">configure your motors</a></p>
<p>Download the <a href="https://github.com/poppy-project/poppy_controllers/releases/download/v1.0/poppy-ergo-jr-ros-melodic.img.zip">ROS image</a> to flash an SD card. To flash the image to an SD card:
+ Extract the compressed .zip or .7z file to a folder on the computer
+ Use the software <a href="https://www.balena.io/etcher/">etcher</a> (or equivalent)
+ In Etcher, &quot;Flash from file&quot;, select the image file and the destination (the SD card) and validate</p>
<p>To connect the robot in Wifi :
+ Insert the SD card of the robot in question in your workstation and open the partition named <em>boot</em> + Download the file <a href="">wpa_supplicant.conf</a> in boot and modify it to fill in the right wifi password inside.
+ Download the file <a href="https://files.ros4.pro/wpa_supplicant.conf">wpa_supplicant.conf</a> in boot and modify it to fill in the right wifi password inside
+ Create an empty file named <em>.ssh</em> in the same place in the <em>boot</em>.
+ Type the command <em>sync</em> and cleanly assign the SD card</p>
<p>These 2 files <em>wpa_supplicant.conf</em> and <em>.ssh</em> will be deleted the next time the robot is started, indicating that the Wifi connection request has been accepted. It is therefore normal that you will not find them when you look at the boot content again after the first start of the robot.</p>
<p>In case of problems, it is possible to connect an HDMI display to the Raspberry Pi, the network manager is on the top right.</p>
<p>The Wi-Fi connection also works with Android and iOS mobile access points.</p>
<p>Make sure that the <code>ROS_MASTER_URI</code> on your workstation and on your poppy point to the same address. If not, modify and source your <code>.bashrc</code>.</p>
<p>The controller is already on the robot. You can connect directly to the robot and start it. If you have chosen to point the <code>ROS_MASTER_URI</code> at your workstation, do not forget to run a <code>roscore</code> before</p>
<pre><code class="language-bash">ssh pi@poppy.local
roslaunch poppy_controllers control.launch
</code></pre>
<h2 id="start-moveit-with-a-real-robot"><a class="header" href="#start-moveit-with-a-real-robot">Start MoveIt with a real robot</a></h2>
<p>Install MoveIt then clone the ROS package <strong>Poppy Ergo Jr MoveIt Configuration</strong>, it contains the code needed to make this robot work with MoveIt :</p>
<pre><code class="language-bash">sudo apt install ros-noetic-moveit
cd $HOME/catkin_ws/src
git clone https://github.com/poppy-project/poppy_ergo_jr_moveit_config.git
cd $HOME/catkin_ws/
catkin_make 
source $HOME/.bashrc
</code></pre>
<p>Start MoveIt with <code>roslaunch</code> with the <code>fake_execution</code> parameter set to <code>false</code> to connect to the real robot:</p>
<pre><code class="language-bash">roslaunch poppy_ergo_jr_moveit_config demo.launch fake_execution:=false gripper:=true
</code></pre>
<p>Rviz should start with a Poppy Ergo Jr in view corresponding to the state of your robot in real time.</p>
<p>⚠️ At this stage, make sure that the posture of your robot in RViz corresponds to the current posture of the real robot: the angles of the motors and the location of the rivets must correspond in every way to your real robot. It is frequent that robots are incorrectly assembled, in this case close MoveIt and go back to the <a href="https://docs.poppy-project.org/fr/assembly-guides/ergo-jr/">assembly guide</a> step by step to correct before continuing.</p>
<h2 id="start-ronoco"><a class="header" href="#start-ronoco">Start Ronoco</a></h2>
<p>Before starting ronoco it is necessary to provide the robot configuration. Open the file <strong>config.py</strong> in the folder <code>$HOME/catkin_ws/src/ronoco/ronoco-vm/ronoco_vm/</code> and copy and paste the following values</p>
<pre><code class="language-py">&quot;&quot;&quot;
This file gathers all the configuration variables until ronoco-config is created
&quot;&quot;&quot;

socketio = None

# Level of debug
debug = 4

# Move group for moveit
move_group = &quot;arm_and_finger&quot;

# Compliance mode
mode = &quot;/set_compliant&quot;
</code></pre>
<p>The two interesting values are <code>move_group</code> which can be <em>arm_and_finger</em> or <em>arm</em> on Poppy Ergo Jr and <code>mode</code> which tells ronoco about the compliance capabilities of the robot. In our case the robot can be put into and out of compliance mode via the <code>/set_compliant</code> service which we fill in. In the case of a Kuka robot that does not have a compliant mode the value would have been <code>None</code>.</p>
<p>WIP: Pass move_group and mode via roslaunch parameters.</p>
<p>To start ronoco you just need to run the following commands in 3 different terminals</p>
<pre><code class="language-bash"># Launching of nodered in a terminal
node-red
</code></pre>
<pre><code class="language-bash"># Launching of ronoco-vm in another terminal
cd $HOME/catkin_ws/src/ronoco/ronoco-vm/
python3 ronoco_vm/run.py
</code></pre>
<pre><code class="language-bash"># Launching of ronoco-ui in another terminal
cd $HOME/catkin_ws/src/ronoco/ronoco-ui/
npm start
</code></pre>
<p>Once all the modules are running go to your <a href="http://localhost:8080/">localhost:8080</a> and you will arrive at the ronoco page:</p>
<p><img src="../static/ronoco.png" alt="ronoco" /></p>
<h2 id="use-ronoco"><a class="header" href="#use-ronoco">Use Ronoco</a></h2>
<p>For a full understanding of this part it is preferable to have followed the tutorials <a href="how-to-use-it.html">How to use it</a> and <a href="bt.html">How to create a behaviour tree</a></p>
<p>The <a href="../static/demo.mp4">gif</a> below shows a use of Ronoco</p>
<p><img src="../static/demo.gif" alt="demo" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../user-guides/bt.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../user-guides/poppy.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../user-guides/bt.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../user-guides/poppy.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
